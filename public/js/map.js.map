{"version":3,"sources":["../../src/map.js"],"names":[],"mappings":";;AACA,IAAI,WAAW,GAAG,CAAC,UAAU,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE;AACtD,QAAI,MAAM,GAAG,EAAE,CAAC;;AAEhB,UAAM,CAAC,cAAc,GAAG,UAAU,EAAE,EAAE,QAAQ,EAAE;AAC5C,eAAO,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;KAC/B,CAAC;;AAEF,UAAM,CAAC,IAAI,GAAG,KAAK,CAAC,WAAW,CAAC;;;AAC5B,oBAAY,EAAE;AACV,kBAAM,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI;SAC/B;;AAED,yBAAiB,EAAE,6BAAY;AAC3B,gBAAI,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;;AAE/D,aAAC,CAAC,SAAS,CAAC,mDAAmD,EACvD;AACI,uBAAO,EAAE,CAAC;AACV,uBAAO,EAAE,CAAC;AACV,2BAAW,EAAE,mFAAmF;aACnG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;;AAGtB,gBAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;;AAEnB,kBAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,UAAS,GAAG,EAAE;AAC1C,uBAAO,GAAG,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC;aACvC,CAAC,CAAC,OAAO,CAAC,CAAA,UAAU,GAAG,EAAE;AACtB,mBAAG,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,CAAA,UAAS,QAAQ,EAAE;AAC5C,wBAAI,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AAC1B,wBAAI,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;;AAE1B,wBAAI,QAAQ,GAAG,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AACjC,wBAAI,QAAQ,IAAI,SAAS,EACrB,QAAQ,GAAG,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC,KAC3B,IAAI,QAAQ,IAAI,OAAO,EACxB,QAAQ,GAAG,EAAC,IAAI,EAAE,SAAS,EAAC,CAAC,KAE7B,QAAQ,GAAG,EAAE,CAAC;;AAElB,wBAAI,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,QAAQ,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AACvD,wBAAI,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,EAAE;AAC1B,4BAAI,QAAQ,GAAG,eAAe,GAAG,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAC/C,4BAAI,KAAK,GAAG,4CAA4C,GAAG,QAAQ,GAAG,UAAU,GAAG,QAAQ,GAAG,IAAI,GAC1F,qBAAqB,GAAG,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,uBAAuB,GAClE,gBAAgB,CAAC;qBAC5B,MAAM;AACH,4BAAI,QAAQ,GAAG,IAAI,CAAC;AACpB,4BAAI,KAAK,GAAG,EAAE,CAAC;qBAClB;;AAED,wBAAI,KAAK,GAAG,MAAM,CAAC,SAAS,CACxB,OAAO,GACH,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,EAAC,SAAS,EAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC,CAAC,GAAG,GAAG,GACrF,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,MAAM,GAChC,wBAAwB,GACxB,MAAM,GACN,KAAK,GACT,QAAQ,CACX,CAAC;;AAEF,wBAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;iBAC9B,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;aACjB,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACjB;;AAED,cAAM,EAAE,kBAAY;AAChB,mBAAO,6BAAK,SAAS,EAAC,aAAa,GAAG,CAAA;SACzC;KACJ,CAAC,CAAC;;AAEH,WAAO,MAAM,CAAC;CACjB,CAAA,CAAE,MAAM,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC","file":"map.js","sourcesContent":["\nvar LanguageMap = (function (Stores, Actions, Dispatcher) {\n    var module = {};\n\n    module.popup_callback = function (id, audio_id) {\n        Actions.app.showDetails(id);\n    };\n\n    module.view = React.createClass({\n        contextTypes: {\n            router: React.PropTypes.func\n        },\n\n        componentDidMount: function () {\n            var map = L.map(this.getDOMNode()).setView([51.505, -0.09], 2);\n\n            L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n                    {\n                        minZoom: 2, \n                        maxZoom: 8, \n                        attribution: 'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors'\n                    }).addTo(map);\n\n\n            this._markers = [];\n            \n            Stores.language.getAll().filter(function(row) {\n                return row.get('positions') != null;\n            }).forEach(function (row) {\n                row.get('positions').forEach(function(position) {\n                    var lat = position.get(0);\n                    var lon = position.get(1);\n\n                    var icon_opt = row.get('status');\n                    if (icon_opt == \"dangers\")\n                        icon_opt = {icon: LRedIcon};\n                    else if (icon_opt == \"morte\")\n                        icon_opt = {icon: LGreyIcon};\n                    else\n                        icon_opt = {};\n\n                    var marker = L.marker([lat, lon], icon_opt).addTo(map);\n                    if (row.get('audio') != null) {\n                        var audio_id = 'audio-player-' + row.get('id');\n                        var audio = '<hr /><div><audio controls=\"controls\" id=\"' + audio_id + '\" name=\"' + audio_id + '\">' +\n                                '<source src=\"audio/' + row.get('audio') + '\" type=\"audio/mpeg\"/>' + \n                                '</audio></div>';\n                    } else {\n                        var audio_id = null;\n                        var audio = '';\n                    }\n\n                    var popup = marker.bindPopup(\n                        '<div>' +\n                            '<a href=' + this.context.router.makeHref('langue', {langue_id: row.get('id')}) + '>' + \n                            '<b>' + row.get('name') + '</b>' + \n                            ' - Plus d\\'information' + \n                            '</a>' +\n                            audio +\n                        '</div>'\n                    );\n\n                    this._markers.push(marker);\n                }.bind(this));\n            }.bind(this));\n        },\n\n        render: function () {\n            return <div className=\"leaflet-map\" />\n        },\n    });\n\n    return module;\n})(Stores, Actions, Dispatcher);\n"]}